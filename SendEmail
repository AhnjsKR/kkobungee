
  """
  KKOBUNGEE
  """

  __author__ = "AhnJungSun"
  __version__ = "0.3.0"
  __license__ = "NONE"

import requests
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

def get_weather(api_key, city):
    base_url = "http://api.openweathermap.org/data/2.5/weather"
    params = {
        'q': city,
        'appid': api_key,
        'units': 'metric'  # You can change this to 'imperial' for Fahrenheit
    }
    response = requests.get(base_url, params=params)
    data = response.json()

    if response.status_code == 200:
        weather_description = data['weather'][0]['description']
        temperature = data['main']['temp']
        humidity = data['main']['humidity']
        return f"오늘의 서울 날씨: {weather_description}\n온도 : {temperature}°C'\n습도 :{humidity}%"
    else:
        return '날씨 정보를 가져오는 데 실패했습니다.'

def send_email(sender_email, receiver_email, app_password, subject, text, html):
    message = MIMEMultipart("alternative")
    message["Subject"] = subject
    message["From"] = sender_email
    message["To"] = receiver_email

    part1 = MIMEText(text, "plain")
    part2 = MIMEText(html, "html")

    message.attach(part1)
    message.attach(part2)

    with smtplib.SMTP_SSL("smtp.gmail.com", 465) as server:
        server.login(sender_email, app_password)
        server.sendmail(sender_email, receiver_email, message.as_string())

if __name__ == "__main__":
    sender_email = "kkobung82@gmail.com"
    receiver_email = "ahnjs252002@gmail.com"
    app_password = "slgt zwrr tgpl sycb"
    api_key = "68d883c6f808e052920bea6a1e9001b2"  # Replace with your actual API key
    city = "Seoul"  # Replace with the city for which you want the weather information

    weather_info = get_weather(api_key, city)

    subject = "Practice3 - 오늘의 서울 날씨"
    text = f"오늘도 좋은 하루 보내세요!. {weather_info}"
    html = f"<html><body><p>오늘도 좋은 하루 보내세요! {weather_info}</p></body></html>"

    send_email(sender_email, receiver_email, app_password, subject, text, html)
  if __name__ == "__main__":
      sender_email = "kkobung82@gmail.com"
      receiver_email = "ahnjs252002@gmail.com"
      app_password = "slgt zwrr tgpl sycb"
 
      subject = "Practice1"
      text = "Hi."
      html = f"<html><body><p>{text}</p></body></html>"
 
      send_email(sender_email, receiver_email, app_password, subject, text, html)
